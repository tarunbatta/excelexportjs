/*! @tarunbatta/excelexportjs 2018-01-05 */

"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var excelExportJs;!function(excelExportJs){var eeCellTypes;!function(eeCellTypes){eeCellTypes[eeCellTypes.Boolean=0]="Boolean",eeCellTypes[eeCellTypes.DateTime=1]="DateTime",eeCellTypes[eeCellTypes.Float=2]="Float",eeCellTypes[eeCellTypes.Html=3]="Html",eeCellTypes[eeCellTypes.Number=4]="Number",eeCellTypes[eeCellTypes.Percent=5]="Percent",eeCellTypes[eeCellTypes.String=6]="String"}(eeCellTypes=excelExportJs.eeCellTypes||(excelExportJs.eeCellTypes={}));var eeHorizontalCellAlignment;!function(eeHorizontalCellAlignment){eeHorizontalCellAlignment.Center="Center",eeHorizontalCellAlignment.Left="Left",eeHorizontalCellAlignment.Right="Right"}(eeHorizontalCellAlignment=excelExportJs.eeHorizontalCellAlignment||(excelExportJs.eeHorizontalCellAlignment={}));var eeVerticalCellAlignment;!function(eeVerticalCellAlignment){eeVerticalCellAlignment.Bottom="Bottom",eeVerticalCellAlignment.Center="Center",eeVerticalCellAlignment.Top="Top"}(eeVerticalCellAlignment=excelExportJs.eeVerticalCellAlignment||(excelExportJs.eeVerticalCellAlignment={}));var eeAlignment=function(){return function(hAlign,vAlign,isWrap){this.hAlign=hAlign||eeHorizontalCellAlignment.Left,this.vAlign=vAlign||eeVerticalCellAlignment.Center,this.isWrap=isWrap||!1}}();excelExportJs.eeAlignment=eeAlignment;var eeBackground=function(){return function(color,pattern){this.color=color||"#FFFFFF",this.pattern=pattern||"Solid"}}();excelExportJs.eeBackground=eeBackground;var eeFont=function(){return function(name,family,size,color,isBold){this.name=name||"Calibri",this.family=family||"Swiss",this.size=size||10,this.color=color||"#000000",this.isBold=isBold||!1}}();excelExportJs.eeFont=eeFont;var eeCellStyle=function(){return function(background,alignment,font,isBordered){this.styleId=null,this.background=background||new eeBackground,this.alignment=alignment||new eeAlignment,this.font=font||new eeFont,this.isBordered=isBordered||!1}}();excelExportJs.eeCellStyle=eeCellStyle;var eeColumnType=function(){return function(_celltype){if(this._celltype=eeCellTypes.String,this.cellType="String",this.format="@",_celltype)switch(this._celltype=_celltype,_celltype){case eeCellTypes.Boolean:this.cellType="Boolean",this.format="";break;case eeCellTypes.DateTime:this.cellType="DateTime",this.format="[ENG][$-409]d-mmm-yyyy;@";break;case eeCellTypes.Float:this.cellType="Number",this.format="Fixed";break;case eeCellTypes.Html:this.cellType="String",this.format="@";break;case eeCellTypes.Number:this.cellType="Number",this.format="0";break;case eeCellTypes.Percent:this.cellType="Number",this.format="Percent";break;default:this.cellType="String",this.format="@"}}}();excelExportJs.eeColumnType=eeColumnType;var eeCell=function(){return function(data){this.data=data}}();excelExportJs.eeCell=eeCell;var eeRow=function(){return function(data){this.items=data}}();excelExportJs.eeRow=eeRow;var eeColumn=function(){return function(name,headerText,type,width,isVisible,style){this.name=name,this.headerText=headerText,this.type=type,this.width=width||100,this.isVisible=isVisible||!0,this.style=style||new eeCellStyle(new eeBackground,new eeAlignment(eeHorizontalCellAlignment.Left,eeVerticalCellAlignment.Center),new eeFont,!0)}}();excelExportJs.eeColumn=eeColumn;var eeTable=function(){return function(name,columns,rows,headerStyle,defaultColumnWidth,defaultRowWidth){this.name=name,this.columns=columns,this.rows=rows,this.headerStyle=headerStyle||new eeCellStyle(new eeBackground("#FFC000"),new eeAlignment(eeHorizontalCellAlignment.Center,eeVerticalCellAlignment.Center),new eeFont(null,null,11,null,!0),!0),this.defaultColumnWidth=defaultColumnWidth||null,this.defaultRowWidth=defaultRowWidth||null}}();excelExportJs.eeTable=eeTable;var eeHelper=function(){function eeHelper(){}return eeHelper.RemoveSpaces=function(html){return html.split(/(?:\r\n|\n|\r)/).map(function(line){return line.replace(/^\s+/gm,"")}).join(" ").trim()},eeHelper.htmlEncode=function(html){return String(html).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},eeHelper}();excelExportJs.eeHelper=eeHelper;var excelExport=function(){function excelExport(dataSet,fileName,author,company,version,style){this._dataType="json",this._fileExtension="xml",this._encoding="UTF-8",this.dataSet=dataSet,this.fileName=fileName||"download",this.author=author||"Tarun Batta",this.company=company||"BattaTech Private Ltd.",this.version=version||"1.0",this.style=style||new eeCellStyle(new eeBackground,new eeAlignment(eeHorizontalCellAlignment.Left,eeVerticalCellAlignment.Center),new eeFont)}return excelExport.prototype._GetFileName=function(){return this.fileName+"."+this._fileExtension},excelExport.prototype._GetDocumentProperties=function(){return'<DocumentProperties xmlns="urn:schemas-microsoft-com:office:office">\n                        <Author>'+this.author+"</Author>\n                        <Created>"+(new Date).toISOString()+"</Created>\n                        <Company>"+this.company+"</Company>\n                        <Version>"+this.version+"</Version>\n                    </DocumentProperties>"},excelExport.prototype._GetOfficeDocumentSettings=function(){return'<OfficeDocumentSettings xmlns="urn:schemas-microsoft-com:office:office">\n                        <AllowPNG/>\n                    </OfficeDocumentSettings>'},excelExport.prototype._GetExcelWorkbook=function(){return'<ExcelWorkbook xmlns="urn:schemas-microsoft-com:office:excel">\n                        <WindowHeight>8958</WindowHeight>\n                        <WindowWidth>11358</WindowWidth>\n                        <WindowTopX>480</WindowTopX>\n                        <WindowTopY>18</WindowTopY>\n                        <ProtectStructure>False</ProtectStructure>\n                        <ProtectWindows>False</ProtectWindows>\n                    </ExcelWorkbook>'},excelExport.prototype._GetBorders=function(style){return style&&style.isBordered?'<Borders>\n                            <Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>\n                            <Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/>\n                            <Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/>\n                            <Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/>\n                        </Borders>':"<Borders/>"},excelExport.prototype._GetAlignment=function(style){var result="";if(style){var wrap=style.alignment.isWrap?1:0;result='<Alignment ss:Horizontal="'+style.alignment.hAlign+'" ss:Vertical="'+style.alignment.vAlign+'" ss:WrapText="'+wrap+'"/>'}else result="<Alignment/>";return result},excelExport.prototype._GetBackground=function(style){return style?'<Interior ss:Color="'+style.background.color+'" ss:Pattern="'+style.background.pattern+'"/>':"<Interior/>"},excelExport.prototype._GetFont=function(style){var result="";if(style){var bold=style.font.isBold?1:0;result='<Font ss:FontName="'+style.font.name+'" x:Family="'+style.font.family+'" ss:Size="'+style.font.size+'" ss:Color="'+style.font.color+'" ss:Bold="'+bold+'"/>'}else result="<Font/>";return result},excelExport.prototype._GetNumberFormat=function(column){var result="";if(column)switch(column.type._celltype){case eeCellTypes.Boolean:result="<NumberFormat/>";break;default:result='<NumberFormat ss:Format="'+column.type.format+'"/>'}else result="<NumberFormat/>";return result},excelExport.prototype._GetStyles=function(){var _this=this,result="<Styles>";return result+='<Style ss:ID="Default" ss:Name="Normal">\n                            '+this._GetAlignment(this.style)+"\n                            "+this._GetBorders(this.style)+"\n                            "+this._GetFont(this.style)+"\n                            "+this._GetBackground(this.style)+"\n                            "+this._GetNumberFormat(null)+"\n                            <Protection/>\n                        </Style>",this.dataSet.forEach(function(item,itable){result+='<Style ss:ID="'+("w"+itable+"h")+'" >\n                                '+_this._GetAlignment(item.headerStyle)+"\n                            </Style>",item.columns.forEach(function(column,icolumn){result+='<Style ss:ID="'+("w"+itable+"hc"+icolumn)+'" >\n                                    '+_this._GetAlignment(item.headerStyle)+"\n                                    "+_this._GetBorders(item.headerStyle)+"\n                                    "+_this._GetFont(item.headerStyle)+"\n                                    "+_this._GetBackground(item.headerStyle)+"\n                                    "+_this._GetNumberFormat(column)+"\n                                </Style>";result+='<Style ss:ID="'+("w"+itable+"c"+icolumn)+'" >\n                                    '+_this._GetAlignment(column.style)+"\n                                    "+_this._GetBorders(column.style)+"\n                                    "+_this._GetFont(column.style)+"\n                                    "+_this._GetNumberFormat(column)+"\n                                </Style>"}),item.rows.forEach(function(row,irow){row&&row.items.forEach(function(rowItem,irowItem){Object.keys(rowItem).forEach(function(key,ikey){if("object"==typeof rowItem[key]){result+='<Style ss:ID="'+("w"+itable+"c"+irowItem+"r"+ikey)+'" >\n                                                    '+_this._GetAlignment(rowItem[key].style)+"\n                                                    "+_this._GetBorders(rowItem[key].style)+"\n                                                    "+_this._GetFont(rowItem[key].style)+"\n                                                    "+_this._GetBackground(rowItem[key].style)+"\n                                                    "+_this._GetNumberFormat(item.columns[ikey])+"\n                                                </Style>",rowItem[key].style.styleId="w"+itable+"c"+irowItem+"r"+ikey}})})})}),result+="</Styles>"},excelExport.prototype._GetWorkSheets=function(){var _this=this,result="";return this.dataSet.forEach(function(item,itable){var rows='<Row ss:AutoFitHeight="0">',cols="";item.columns.forEach(function(column,icolumn){cols+='<Column ss:AutoFitWidth="0" ss:StyleID="'+("w"+itable+"h")+'" ss:Width="'+column.width+'" />';rows+='<Cell ss:StyleID="'+("w"+itable+"hc"+icolumn)+'">\n                                <Data ss:Type="String">'+column.headerText+"</Data>\n                            </Cell>"}),rows+="</Row>",item.rows.forEach(function(row,irow){row&&row.items.forEach(function(rowItem,irowItem){rows+='<Row ss:AutoFitHeight="0">',Object.keys(rowItem).forEach(function(key,ikey){var styleId,cellData;if("object"==typeof rowItem[key])styleId=rowItem[key].style.styleId,cellData=rowItem[key].data;else{styleId="w"+itable+"c"+ikey,cellData=rowItem[key]}switch(item.columns[ikey].type._celltype){case eeCellTypes.Boolean:cellData=cellData?1:0;break;case eeCellTypes.DateTime:cellData=new Date(cellData).toISOString();break;case eeCellTypes.Html:cellData=eeHelper.htmlEncode(cellData)}rows+='<Cell ss:StyleID="'+styleId+'">\n                                            <Data ss:Type="'+item.columns[ikey].type.cellType+'">'+cellData+"</Data>\n                                        </Cell>"}),rows+="</Row>"})});var rowCount=item.rows[0]?item.rows[0].items.length+1:1,table='<Table ss:ExpandedColumnCount="'+item.columns.length+'" ss:ExpandedRowCount="'+rowCount+'" x:FullColumns="1" x:FullRows="1"';item.defaultColumnWidth&&(table+='ss:DefaultColumnWidth="'+item.defaultColumnWidth+'"'),item.defaultRowWidth&&(table+='ss:DefaultRowHeight="'+item.defaultRowWidth+'"'),table+=">",table+=cols,table+=rows,table+="</Table>";var workSheet='<Worksheet ss:Name="'+item.name+'">\n                            '+table+"\n                            "+_this._GetWorksheetOptions()+"\n                        </Worksheet>";result+=workSheet}),result},excelExport.prototype._GetWorksheetOptions=function(){return'<WorksheetOptions xmlns="urn:schemas-microsoft-com:office:excel">\n                        <PageSetup>\n                            <Header x:Margin="0.3"/>\n                            <Footer x:Margin="0.3"/>\n                            <PageMargins x:Bottom="0.75" x:Left="0.7" x:Right="0.7" x:Top="0.75"/>\n                        </PageSetup>\n                        <Unsynced/>\n                        <Print>\n                            <ValidPrinterInfo/>\n                            <HorizontalResolution>600</HorizontalResolution>\n                            <VerticalResolution>600</VerticalResolution>\n                        </Print>\n                        <Selected/>\n                        <Panes>\n                            <Pane>\n                                <Number>3</Number>\n                                <ActiveRow>1</ActiveRow>\n                                <ActiveCol>1</ActiveCol>\n                            </Pane>\n                        </Panes>\n                        <ProtectObjects>False</ProtectObjects>\n                        <ProtectScenarios>False</ProtectScenarios>\n                    </WorksheetOptions>'},excelExport.prototype.CreateExcel=function(isCompressed,returnUrl){var result="";if(result='<?xml version="1.0"?>\n                    <?mso-application progid="Excel.Sheet"?>\n                    <Workbook xmlns="urn:schemas-microsoft-com:office:spreadsheet"\n                        xmlns:o="urn:schemas-microsoft-com:office:office"\n                        xmlns:x="urn:schemas-microsoft-com:office:excel"\n                        xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet"\n                        xmlns:html="http://www.w3.org/TR/REC-html40">\n                        '+this._GetDocumentProperties()+"\n                        "+this._GetOfficeDocumentSettings()+"\n                        "+this._GetExcelWorkbook()+"\n                        "+this._GetStyles()+"\n                        "+this._GetWorkSheets()+"\n                    </Workbook>",isCompressed&&(result=eeHelper.RemoveSpaces(result)),returnUrl){var blob=new Blob([result],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset="+this._encoding});result=window.URL.createObjectURL(blob)}return result},excelExport}();excelExportJs.excelExport=excelExport}(excelExportJs=exports.excelExportJs||(exports.excelExportJs={}));